/*! Cross Query - v0.0.8
 * 
 * Copyright (c) 2014; * Licensed GPLv2+ */
window.xq=function(a,b,c){"use strict";function d(a,b){var c,d={requests:{},timeout:{},queue:[],delay:5e3,paused:!1};return b=b||{},"number"!=typeof b.timeout||isNaN(b.timeout)||(d.delay=parseInt(b.timeout,10),delete b.timeout),"object"==typeof a&&"IFRAME"===a.nodeName&&(d.frameRef=a,a=d.frameRef.src),u[a]?u[a].publicObj:(c=a.match(/^(https?:\/\/[^\/]*)(.*)?/),d.origin=c[1],d.path=c[2],d.url=a,d.frameRef&&!v[a]?d.frameRef.contentWindow.postMessage('{ "action": "ping" }',d.origin):d.frameRef||e.call(d,b),d.publicObj={query:s(d,q),get:s(d,e),pause:s(d,h),play:s(d,i),refresh:s(d,l)},u[d.url]=d,d.publicObj)}function e(a){return(c===this.frameRef||this.frameRef.closed)&&(a=a||{},!0===a.window&&(this.openWin=g(a)),c!==this.openWin?this.openWin.call(this):this.frameRef=f(a,this.origin+this.path)),this.frameRef}function f(a,c){var d;return d=b.createElement("iframe"),d=r(d,r(a,w),!0),d.src=c,b.body.appendChild(d),d}function g(b){return function(){this.frameRef=a.open(this.url,"",b.attrs)}}function h(){this.paused=!0}function i(){this.paused=!1,m.call(this)}function j(a){var b,c;"string"==typeof a&&(c=v[a],b=u[a],v[a]=!0,b&&!c&&m.call(b))}function k(a){"string"==typeof a&&(v[a]=!1)}function l(){var a=e.call(this);c===a.closed?a.src=this.url:a.location=this.url}function m(){if(v[this.origin+this.path]&&!this.paused)for(var a=this.queue.shift();a;)o.call(this,a.key,a.timeout),a=this.queue.shift()}function n(b){var c,d,f;if(b.data){try{c=JSON.parse(b.data)}catch(g){return}"xq-init"===c.init?j(c.server):"xq-de-init"===c.init&&k(c.server),c.url&&c.key&&c.data&&(d=u[c.url],f="notify"===c.success?"notifyWith":c.success?"resolveWith":"rejectWith",d&&d.requests[c.key]&&(a.clearTimeout(d.timeout[c.key]),d.requests[c.key][f](e.call(d),[c.data])))}}function o(b,d){var f=e.call(this);f=c===f.closed?f.contentWindow:f,d="number"!=typeof d||isNaN(d)?this.delay:parseInt(d,10),f.postMessage&&v[this.url]?(f.postMessage(b,this.origin),d>0&&(this.timeout[b]=a.setTimeout(p(this,b),d))):(this.queue.unshift({key:b,timeout:d}),l.call(this))}function p(a,b){return function(){a.requests[b].rejectWith(e.call(a),[{error:"The request timed out"}])}}function q(a,b){var d,f;return"object"!=typeof a?!1:(d=JSON.stringify(a),b=b||{},!0===b.cache&&c!==this.requests[d]?this.requests[d].promise():(this.requests[d]=jQuery.Deferred(),v[this.url]&&!this.paused?o.call(this,d,b.timeout):(this.queue.push({key:d,timeout:b.timeout}),f=e.call(this),c===f.closed&&this.url!==f.src&&l.call(this)),this.requests[d].promise()))}function r(a,b,c){var d;a=a||{};for(d in b)"object"==typeof b[d]?r(a[d],b[d]):(c||!a[d])&&(a[d]=b[d]);return a}function s(a,b){return"object"==typeof a&&"function"==typeof b?function(){return b.apply(a,arguments)}:void 0}var jQuery,t=t||{},u={},v={},w={width:"0",height:"0",frameBorder:"0",style:{display:"none"}};return jQuery=a.jQuery||{},jQuery.Deferred=jQuery.Deferred||t,a.addEventListener?a.addEventListener("message",n,!1):a.attachEvent&&a.attachEvent("onmessage",n),d}(window,document);